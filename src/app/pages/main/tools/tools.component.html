<h1 class="text-3xl font-bold text-text-main mb-8">å·¥å…·ä¸‹è½½</h1>

<div class="mb-8">
  <div class="border-b border-dark">
    <nav class="-mb-px flex space-x-6 overflow-x-auto" aria-label="Tabs">
      @for (category of categories; track category.platformId) {
        <button
          (click)="setActiveTab(category.platformId)"
          [class.border-accent-start]="activeTab() === category.platformId"
          [class.text-accent-start]="activeTab() === category.platformId"
          [class.border-transparent]="activeTab() !== category.platformId"
          [class.text-text-muted]="activeTab() !== category.platformId"
          [class.hover:text-text-main]="activeTab() !== category.platformId"
          [class.hover:border-dark/50]="activeTab() !== category.platformId"
          class="group whitespace-nowrap inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 focus:outline-none">
          <svg class="h-5 w-5 mr-2" [class.text-accent-start]="activeTab() === category.platformId" [class.text-text-muted/60]="activeTab() !== category.platformId" [class.group-hover:text-text-muted]="activeTab() !== category.platformId" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" [attr.d]="category.iconPath" />
          </svg>
          <span>{{ category.platformName }}</span>
        </button>
      }
    </nav>
  </div>
</div>

@for (category of categories; track category.platformId) {
  @if (activeTab() === category.platformId) {
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 animate-fade-in">
      @for (tool of category.tools; track tool.name) {
        <div class="bg-surface rounded-2xl shadow-neumorphic-raised flex flex-col">
          <div class="p-6 flex-grow">
            <h3 class="text-lg font-semibold text-text-main">{{ tool.name }}</h3>
            <p class="mt-2 text-sm text-text-muted leading-relaxed">{{ tool.description }}</p>
          </div>
          <div class="bg-dark/20 p-4">
            @if (tool.isAppStore) {
              <button (click)="openAppStoreInfo(tool.name)" class="w-full py-2.5 px-4 rounded-xl text-white font-semibold transition-all duration-200 ease-in-out transform hover:-translate-y-0.5 active:translate-y-0.5 bg-gradient-to-br from-purple-500 to-indigo-600 shadow-neumorphic-raised hover:shadow-neumorphic-pressed active:shadow-neumorphic-sunken">
                è·å–æŒ‡å—
              </button>
            } @else {
              <a [href]="tool.downloadUrl" download class="block text-center w-full py-2.5 px-4 rounded-xl text-white font-semibold transition-all duration-200 ease-in-out transform hover:-translate-y-0.5 active:translate-y-0.5 bg-gradient-to-br from-accent-start to-accent-end shadow-neumorphic-raised hover:shadow-neumorphic-pressed active:shadow-neumorphic-sunken">
                ä¸‹è½½
              </a>
            }
          </div>
        </div>
      }
    </div>
  }
}

<div class="mt-16 space-y-12">
  <div class="bg-surface p-8 rounded-2xl shadow-neumorphic-raised">
    <div class="flex items-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-accent-start" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <h2 class="ml-3 text-2xl font-bold text-text-main">ğŸ“± ä½¿ç”¨è¯´æ˜</h2>
    </div>
    <ul class="mt-4 list-disc list-inside space-y-2 text-text-muted">
      <li>é€‰æ‹©é€‚åˆæ‚¨è®¾å¤‡çš„å®¢æˆ·ç«¯è¿›è¡Œä¸‹è½½å®‰è£…</li>
      <li>å®‰è£…å®Œæˆåï¼Œä½¿ç”¨ä»ªè¡¨ç›˜ä¸­çš„è®¢é˜…é“¾æ¥æˆ–äºŒç»´ç å¯¼å…¥é…ç½®</li>
      <li>å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æŸ¥çœ‹å®¢æˆ·ç«¯çš„ä½¿ç”¨æ•™ç¨‹æˆ–è”ç³»å®¢æœ</li>
    </ul>
  </div>

  <div class="bg-surface p-8 rounded-2xl shadow-neumorphic-raised">
    <div class="flex items-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-accent-end" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.196-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
      </svg>
      <h2 class="ml-3 text-2xl font-bold text-text-main">æ¨èå®¢æˆ·ç«¯</h2>
    </div>
    <div class="mt-4 grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4">
       <div class="p-4 rounded-xl text-center bg-dark shadow-neumorphic-sunken"><p class="font-semibold text-teal-400">Android</p><p class="text-sm text-text-muted">Clash Meta</p></div>
       <div class="p-4 rounded-xl text-center bg-dark shadow-neumorphic-sunken"><p class="font-semibold text-green-400">iOS</p><p class="text-sm text-text-muted">Shadowrocket</p></div>
       <div class="p-4 rounded-xl text-center bg-dark shadow-neumorphic-sunken"><p class="font-semibold text-gray-400">macOS</p><p class="text-sm text-text-muted">Clash Verge Rev</p></div>
       <div class="p-4 rounded-xl text-center bg-dark shadow-neumorphic-sunken"><p class="font-semibold text-blue-400">Windows</p><p class="text-sm text-text-muted">Clash Verge Rev</p></div>
       <div class="p-4 rounded-xl text-center bg-dark shadow-neumorphic-sunken"><p class="font-semibold text-purple-400">Linux</p><p class="text-sm text-text-muted">Clash Verge Rev</p></div>
    </div>
  </div>
</div>

@if (showAppStoreModal()) {
  <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" (click)="closeAppStoreModal()">
    <div class="bg-surface rounded-2xl shadow-neumorphic-raised w-full max-w-lg" (click)="$event.stopPropagation()">
      <div class="p-6 border-b border-dark">
        <h3 class="text-lg font-semibold text-text-main">{{ appStoreModalContent().title }}</h3>
      </div>
      <div class="p-6">
        <p class="text-text-muted mb-4">
          æ‚¨é€‰æ‹©çš„å®¢æˆ·ç«¯ <strong class="text-accent-start">{{ appStoreModalContent().toolName }}</strong> éœ€è¦é€šè¿‡è‹¹æœ App Store ä¸‹è½½ã€‚
        </p>
        <p class="text-text-muted mb-4">
          ç”±äºæ”¿ç­–åŸå› ï¼Œæ‚¨éœ€è¦ä½¿ç”¨éä¸­å›½å¤§é™†åœ°åŒºçš„ Apple ID ç™»å½• App Store æ‰èƒ½æœç´¢å’Œè´­ä¹°ã€‚
        </p>
        <ul class="list-disc list-inside space-y-2 text-sm text-text-muted bg-dark/50 p-4 rounded-xl shadow-neumorphic-sunken">
            <li>æˆ‘ä»¬ä¸æä¾› Apple IDï¼Œè¯·è‡ªè¡Œå‡†å¤‡ã€‚</li>
            <li>åœ¨ App Store ä¸­æœç´¢åº”ç”¨åç§°å³å¯æ‰¾åˆ°ã€‚</li>
            <li>éƒ¨åˆ†åº”ç”¨å¯èƒ½éœ€è¦ä»˜è´¹è´­ä¹°ï¼Œè¯·æ”¯æŒæ­£ç‰ˆã€‚</li>
        </ul>
      </div>
      <div class="px-6 py-4 bg-dark/50 border-t border-dark text-right">
        <button (click)="closeAppStoreModal()" class="px-5 py-2.5 rounded-xl font-semibold text-white bg-gradient-to-br from-accent-start to-accent-end shadow-neumorphic-raised hover:shadow-neumorphic-pressed active:shadow-neumorphic-sunken transition-all">
          æˆ‘æ˜ç™½äº†
        </button>
      </div>
    </div>
  </div>
}

<style>
  .animate-fade-in {
    animation: fadeIn .5s ease-in-out;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>
